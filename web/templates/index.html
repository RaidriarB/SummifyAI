<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SummifyAI - 文件管理</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        :root {
            --primary-color: #0d6efd;
            --success-color: #198754;
            --danger-color: #dc3545;
            --info-color: #0dcaf0;
            --border-color: #dee2e6;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }
        .progress-container {
            height: 300px;
            overflow-y: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        .progress-container::before {
            content: '> ';
            color: #569cd6;
        }
        .progress-container::after {
            content: '';
            display: inline-block;
            width: 10px;
            height: 20px;
            background-color: #d4d4d4;
            animation: blink 1s steps(2, start) infinite;
        }
        @keyframes blink {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0;
            }
        }
        .table-responsive {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            overflow-x: auto;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px var(--shadow-color);
            background-color: #fff;
        }
        .table-fixed {
            table-layout: auto;
            width: 100%;
        }
        .col-name {
            width: 52%;
            word-break: break-all;
        }
        .col-time {
            width: 180px;
            white-space: nowrap;
            text-align: center;
        }
        .col-actions {
            width: 360px;
            white-space: normal;
        }
        .col-actions .btn-group {
            flex-wrap: wrap;
            align-items: center;
        }
        .col-actions .btn {
            white-space: nowrap;
            margin-bottom: 6px;
        }
        @media (max-width: 1200px) {
            .col-actions {
                width: auto;
            }
        }
        .table {
            margin-bottom: 0;
        }
        .table thead th {
            background-color: #f8f9fa;
            border-bottom: 2px solid var(--border-color);
            padding: 12px;
            font-weight: 600;
        }
        .table td {
            padding: 12px;
            vertical-align: middle;
        }
        .table tr:hover {
            background-color: #f8f9fa;
        }
        @media (max-width: 768px) {
            .table-responsive {
                padding: 5px;
            }
            .table td {
                white-space: normal;
                word-break: break-all;
                min-width: auto;
                max-width: none;
            }
            
            .section-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }

            .modal-dialog {
                margin: 20px;
            }
            .modal-content {
                border-radius: 12px;
                border: none;
                box-shadow: 0 4px 6px var(--shadow-color);
            }
            .modal-header {
                padding: 20px;
                border-bottom: 1px solid var(--border-color);
            }
            .modal-body {
                padding: 20px;
            }
            .modal-footer {
                padding: 20px;
                border-top: 1px solid var(--border-color);
            }
        }
        .table-responsive::-webkit-scrollbar {
            width: 8px;
        }
        .table-responsive::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        .table-responsive::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        .table-responsive::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        .navbar-brand {
            font-weight: bold;
        }
        .section-title {
            margin: 30px 0 20px;
            color: #333;
        }
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .list-group-item {
            border: 1px solid var(--border-color);
            margin-bottom: 8px;
            border-radius: 8px !important;
            transition: all 0.2s ease-in-out;
        }
        .list-group-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px var(--shadow-color);
        }
        .list-group-item.active {
            background-color: #e9ecef;
            border-color: var(--border-color);
            color: #212529;
        }
        .list-group-item.active .btn-primary {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }
        .prompt-shell {
            display: grid;
            grid-template-columns: minmax(220px, 280px) 1fr;
            gap: 16px;
        }
        .prompt-panel {
            background: #f8fafc;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            height: 100%;
        }
        .prompt-panel h6 {
            margin-bottom: 10px;
            font-weight: 600;
        }
        .prompt-search {
            margin-bottom: 10px;
        }
        .prompt-editor-panel {
            background: #ffffff;
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 12px;
            height: 100%;
            display: flex;
            flex-direction: column;
        }
        #promptModal .modal-dialog {
            height: 80vh;
        }
        #promptModal .modal-content {
            height: 100%;
        }
        #promptModal .modal-body {
            height: calc(100% - 120px);
            overflow: hidden;
        }
        #promptModal .prompt-shell {
            height: 100%;
        }
        #promptModal .prompt-panel,
        #promptModal .prompt-editor-panel {
            height: 100%;
        }
        .prompt-editor-toolbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 10px;
        }
        .prompt-editor-toolbar .hint {
            color: #6b7280;
            font-size: 0.85rem;
        }
        #promptEditor {
            flex: 1;
            min-height: 320px;
            border-radius: 10px;
            background: #f9fafb;
        }
        @media (max-width: 992px) {
            .prompt-shell {
                grid-template-columns: 1fr;
            }
        }

        
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="/">SummifyAI</a>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- 已下载文件列表 -->
        <div class="section-header">
            <h2 class="section-title mb-0">已下载文件列表</h2>
            <div class="btn-group">
                <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#promptModal">
                    <i class="bi bi-file-earmark-text"></i> Prompt管理
                </button>
                <button type="button" class="btn btn-warning" data-bs-toggle="modal" data-bs-target="#uploadModal">
                    <i class="bi bi-upload"></i> 上传本地文件
                </button>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#downloadModal">
                    <i class="bi bi-cloud-download"></i> 下载音视频
                </button>
                <button type="button" class="btn btn-secondary" onclick="refreshStatus()">
                    <i class="bi bi-arrow-clockwise"></i> 刷新
                </button>
            </div>
        </div>

        <!-- 下载视频模态框 -->
        <div class="modal fade" id="downloadModal" tabindex="-1" aria-labelledby="downloadModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title" id="downloadModalLabel">下载音视频</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-4">
                        <div class="alert alert-info mb-4">
                            <i class="bi bi-info-circle-fill me-2"></i>
                            支持的平台：哔哩哔哩（bilibili）、小宇宙播客
                        </div>
                        <form id="downloadForm">
                            <div class="mb-4">
                                <label for="videoUrl" class="form-label fw-bold">音视频URL</label>
                                <input type="text" class="form-control form-control-lg" id="videoUrl" name="url" placeholder="请输入视频或播客链接" required>
                            </div>
                            <div class="text-end">
                                <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">取消</button>
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-download me-2"></i>开始下载
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- 本地上传模态框 -->
        <div class="modal fade" id="uploadModal" tabindex="-1" aria-labelledby="uploadModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header bg-warning text-dark">
                        <h5 class="modal-title" id="uploadModalLabel">上传本地文件</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body p-4">
                        <form id="uploadForm">
                            <div class="mb-3">
                                <label for="uploadFiles" class="form-label fw-bold">选择文件（支持多选）</label>
                                <input class="form-control" type="file" id="uploadFiles" name="files" multiple required
                                    accept=".mp4,.avi,.mkv,.mov,.flv,.webm,.m4v,.mp3,.wav,.m4a,.aac,.flac,.ogg,.txt">
                                <div class="form-text">支持音频/视频/文本文件，上传后可建立任务。</div>
                            </div>
                            <div class="mb-3">
                                <label for="uploadSteps" class="form-label fw-bold">任务步骤</label>
                                <select class="form-select" id="uploadSteps">
                                    <option value="12">只做转写（12）</option>
                                    <option value="123">转后修补（123）</option>
                                    <option value="1234">转补总结（1234）</option>
                                    <option value="34">仅AI处理（34，需要txt输入）</option>
                                </select>
                            </div>
                            <div class="form-check mb-3">
                                <input class="form-check-input" type="checkbox" id="uploadAutoStart" checked>
                                <label class="form-check-label" for="uploadAutoStart">上传后自动建立任务</label>
                            </div>
                            <div class="text-end">
                                <button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">取消</button>
                                <button type="submit" class="btn btn-warning">
                                    <i class="bi bi-upload me-2"></i>开始上传
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="table-responsive">
            <table class="table table-striped table-hover table-borderless table-fixed">
                <thead class="table-light" style="border-bottom: 2px solid #dee2e6;">
                    <tr>
                        <th class="col-name">文件名</th>
                        <th class="col-time">上次转写时间</th>
                        <th class="col-actions">操作</th>
                    </tr>
                </thead>
                <tbody id="filesBody">
                    {% for file in files %}
                    <tr>
                        <td class="col-name">{{ file.name }}</td>
                        <td class="col-time">{{ file.last_time }}</td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-outline-primary btn-sm me-2" onclick="startTranscribe('{{ file.name }}', '12')">只做转写</button>
                                <button class="btn btn-outline-info btn-sm me-2" onclick="startTranscribe('{{ file.name }}', '123')">转后修补</button>
                                <button class="btn btn-outline-primary btn-sm me-2" onclick="startTranscribe('{{ file.name }}', '1234')">转补总结</button>
                                <div class="btn-group ms-3" role="group">
                                    <button class="btn btn-info btn-sm me-2" onclick="viewTranscription('{{ file.name }}')">
                                        <i class="bi bi-eye"></i> 查看转写
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="deleteFile('{{ file.name }}')" title="删除文件">
                                        <i class="bi bi-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- 转写进度显示 -->
        <div id="progress" class="progress-container"></div>
    </div>

    <script>
        // WebSocket连接
        const socket = io();
        const progressDiv = document.getElementById('progress');

        // 监听转写进度
        socket.on('transcribe_progress', function(data) {
            progressDiv.innerHTML += data.data + '<br>';
            progressDiv.scrollTop = progressDiv.scrollHeight;
        });

        // 监听转写完成
        socket.on('transcribe_complete', function(data) {
            progressDiv.innerHTML += '转写完成：' + data.filename + '<br>';
            progressDiv.scrollTop = progressDiv.scrollHeight;
            updateFileList();
        });

        // 开始转写
        function startTranscribe(filename, steps) {
            progressDiv.innerHTML = ''; // 清空之前的输出
            fetch('/transcribe', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'filename=' + encodeURIComponent(filename) + '&steps=' + encodeURIComponent(steps)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    progressDiv.innerHTML = '已加入任务队列：' + filename + ' (步骤：' + steps + ')<br>';
                } else {
                    progressDiv.innerHTML = '错误：' + data.message + '<br>';
                }
            });
        }

        // 监听下载进度
        socket.on('download_progress', function(data) {
            progressDiv.innerHTML += data.message + '<br>';
            progressDiv.scrollTop = progressDiv.scrollHeight;
            if (data.status === 'success') {
                setTimeout(() => updateFileList(), 1000);
            }
        });

        // 下载视频
        document.getElementById('downloadForm').onsubmit = function(e) {
            e.preventDefault();
            const url = this.url.value;
            progressDiv.innerHTML = '开始下载：' + url + '<br>';
            fetch('/download', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'url=' + encodeURIComponent(url)
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'error') {
                    progressDiv.innerHTML += '错误：' + data.message + '<br>';
                }
            });
            document.querySelector('#downloadModal .btn-close').click();
        };

        function refreshStatus() {
            updateFileList();
        }

        function renderFileTable(files) {
            const tbody = document.getElementById('filesBody');
            if (!tbody) return;
            tbody.innerHTML = '';
            files.forEach(file => {
                const tr = document.createElement('tr');

                const nameTd = document.createElement('td');
                nameTd.className = 'col-name';
                nameTd.textContent = file.name;

                const timeTd = document.createElement('td');
                timeTd.className = 'col-time';
                timeTd.textContent = file.last_time || '未转写';

                const actionsTd = document.createElement('td');

                const group = document.createElement('div');
                group.className = 'btn-group';
                group.setAttribute('role', 'group');

                const btn12 = document.createElement('button');
                btn12.className = 'btn btn-outline-primary btn-sm me-2';
                btn12.textContent = '只做转写';
                btn12.addEventListener('click', () => startTranscribe(file.name, '12'));

                const btn123 = document.createElement('button');
                btn123.className = 'btn btn-outline-info btn-sm me-2';
                btn123.textContent = '转后修补';
                btn123.addEventListener('click', () => startTranscribe(file.name, '123'));

                const btn1234 = document.createElement('button');
                btn1234.className = 'btn btn-outline-primary btn-sm me-2';
                btn1234.textContent = '转补总结';
                btn1234.addEventListener('click', () => startTranscribe(file.name, '1234'));

                const subGroup = document.createElement('div');
                subGroup.className = 'btn-group ms-3';
                subGroup.setAttribute('role', 'group');

                const viewBtn = document.createElement('button');
                viewBtn.className = 'btn btn-info btn-sm me-2';
                viewBtn.innerHTML = '<i class="bi bi-eye"></i> 查看转写';
                viewBtn.addEventListener('click', () => viewTranscription(file.name));

                const delBtn = document.createElement('button');
                delBtn.className = 'btn btn-outline-danger btn-sm';
                delBtn.title = '删除文件';
                delBtn.innerHTML = '<i class="bi bi-trash"></i>';
                delBtn.addEventListener('click', () => deleteFile(file.name));

                subGroup.appendChild(viewBtn);
                subGroup.appendChild(delBtn);

                group.appendChild(btn12);
                group.appendChild(btn123);
                group.appendChild(btn1234);
                group.appendChild(subGroup);

                actionsTd.appendChild(group);

                tr.appendChild(nameTd);
                tr.appendChild(timeTd);
                tr.appendChild(actionsTd);

                tbody.appendChild(tr);
            });
        }

        function updateFileList() {
            fetch('/files')
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'success') {
                        renderFileTable(data.files || []);
                    }
                });
        }

        // 本地上传
        document.getElementById('uploadForm').onsubmit = function(e) {
            e.preventDefault();
            const files = document.getElementById('uploadFiles').files;
            if (!files || files.length === 0) {
                alert('请选择至少一个文件');
                return;
            }
            const steps = document.getElementById('uploadSteps').value;
            const autoStart = document.getElementById('uploadAutoStart').checked;

            const formData = new FormData();
            for (const file of files) {
                formData.append('files', file);
            }
            formData.append('steps', steps);
            formData.append('auto_start', autoStart ? '1' : '0');

            progressDiv.innerHTML = '开始上传 ' + files.length + ' 个文件...<br>';
            fetch('/upload', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    progressDiv.innerHTML += '上传成功：' + (data.saved || []).join(', ') + '<br>';
                    if (data.queued && data.queued.length > 0) {
                        progressDiv.innerHTML += '已加入任务队列：' + data.queued.join(', ') + '<br>';
                    }
                    if (data.errors && data.errors.length > 0) {
                        data.errors.forEach(err => {
                            progressDiv.innerHTML += '错误：' + err.file + ' - ' + err.message + '<br>';
                        });
                    }
                    setTimeout(() => updateFileList(), 1000);
                } else {
                    progressDiv.innerHTML += '错误：' + data.message + '<br>';
                }
            });
            document.querySelector('#uploadModal .btn-close').click();
        };



        // 查看转写结果
        function viewTranscription(filename) {
            // 移除文件扩展名
            const baseFilename = filename.split('.').slice(0, -1).join('.');
            window.location.href = '/transcribe/' + encodeURIComponent(baseFilename);
        }

        // 删除文件
        function deleteFile(filename) {
            if (!confirm('确定要删除文件 ' + filename + ' 吗？')) {
                return;
            }
            fetch('/delete_all_file/' + encodeURIComponent(filename), {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    location.reload();
                }
            });
        }

        // Prompt管理相关功能
        let currentPromptFile = '';

        // 加载Prompt列表
        function loadPromptList() {
            fetch('/list_prompts')
                .then(response => response.json())
                .then(data => {
                    const promptList = document.getElementById('promptList');
                    promptList.innerHTML = '';
                    data.prompts.forEach(prompt => {
                        const displayName = prompt.replace(/.txt$/, '');
                        const item = document.createElement('div');
                        item.className = 'list-group-item d-flex justify-content-between align-items-center';
                        item.setAttribute('data-prompt', prompt);
                        item.setAttribute('data-name', displayName.toLowerCase());
                        item.innerHTML = `
                            <span class="prompt-name">${displayName}</span>
                            <div class="btn-group">
                                <button class="btn btn-sm btn-primary" onclick="viewPrompt('${prompt}')">查看</button>
                                <button class="btn btn-sm btn-danger" onclick="deletePrompt('${prompt}')">删除</button>
                            </div>
                        `;
                        promptList.appendChild(item);
                    });
                    filterPromptList();
                });
        }

        // 创建新的Prompt
        function createNewPrompt() {
            const filename = prompt('请输入新Prompt文件名：');
            if (filename && filename.trim() !== '') {
                currentPromptFile = filename.endsWith('.txt') ? filename : filename + '.txt';
                // 设置默认的Prompt模板
                document.getElementById('promptEditor').value = `# ${filename.replace(/.txt$/, '')} Prompt模板

## 角色定位

## 任务目标

## 输出格式

## 示例输出
`;
                savePrompt();
            } else {
                alert('文件名不能为空！');
            }
        }

        // 查看Prompt内容
        function viewPrompt(filename) {
            currentPromptFile = filename;
            // 移除所有active类
            document.querySelectorAll('#promptList .list-group-item').forEach(item => {
                item.classList.remove('active');
            });
            // 为当前选中项添加active类
            const selectedItem = document.querySelector(`#promptList .list-group-item[data-prompt="${filename}"]`);
            if (selectedItem) {
                selectedItem.classList.add('active');
            }
            fetch('/view_prompt/' + encodeURIComponent(filename))
                .then(response => response.text())
                .then(content => {
                    document.getElementById('promptEditor').value = content;
                });
        }

        // 保存Prompt
        function savePrompt() {
            if (!currentPromptFile) {
                alert('请先选择或创建一个Prompt文件');
                return;
            }
            const content = document.getElementById('promptEditor').value;
            fetch('/save_prompt', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    filename: currentPromptFile,
                    content: content
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    loadPromptList();
                    alert('保存成功');
                } else {
                    alert('保存失败：' + data.message);
                }
            });
        }

        // 删除Prompt
        function deletePrompt(filename) {
            if (!confirm('确定要删除Prompt文件 ' + filename + ' 吗？')) {
                return;
            }
            fetch('/delete_prompt/' + encodeURIComponent(filename), {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    loadPromptList();
                    if (currentPromptFile === filename) {
                        currentPromptFile = '';
                        document.getElementById('promptEditor').value = '';
                    }
                }
            });
        }

        // 等待DOM加载完成后初始化事件监听
        document.addEventListener('DOMContentLoaded', function() {
            const promptModal = document.getElementById('promptModal');
            if (promptModal) {
                promptModal.addEventListener('show.bs.modal', function () {
                    loadPromptList();
                });
            }
            const promptSearch = document.getElementById('promptSearch');
            if (promptSearch) {
                promptSearch.addEventListener('input', filterPromptList);
            }
        });

        function filterPromptList() {
            const promptSearch = document.getElementById('promptSearch');
            if (!promptSearch) return;
            const keyword = promptSearch.value.trim().toLowerCase();
            document.querySelectorAll('#promptList .list-group-item').forEach(item => {
                const name = item.getAttribute('data-name') || '';
                item.style.display = name.includes(keyword) ? '' : 'none';
            });
        }
    </script>
    <!-- Prompt管理模态框 -->
    <div class="modal fade" id="promptModal" tabindex="-1" aria-labelledby="promptModalLabel" data-bs-backdrop="static" data-bs-keyboard="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="promptModalLabel">Prompt管理</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="prompt-shell">
                        <div class="prompt-panel">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="mb-0">Prompt列表</h6>
                                <button type="button" class="btn btn-sm btn-success" onclick="createNewPrompt()">新建</button>
                            </div>
                            <input type="text" class="form-control form-control-sm prompt-search" id="promptSearch" placeholder="搜索 Prompt">
                            <div class="list-group" id="promptList">
                                <!-- Prompt列表将通过JavaScript动态加载 -->
                            </div>
                        </div>
                        <div class="prompt-editor-panel">
                            <div class="prompt-editor-toolbar">
                                <div>
                                    <div class="fw-semibold">编辑区域</div>
                                    <div class="hint">支持 Markdown 语法，建议注明输出格式</div>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-sm btn-outline-secondary" onclick="savePrompt()">保存</button>
                                </div>
                            </div>
                            <textarea class="form-control" id="promptEditor" rows="10" style="font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="savePrompt()">保存</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
